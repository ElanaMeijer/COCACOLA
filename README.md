Welcome to use COCACOLA (binning metagenomic contigs using sequence COmposition, read CoverAge, CO-alignment, and paired-end read LinkAge)!
===================

COCACOLA is a general framework that combines different types of information: sequence COmposition, CoverAge across multiple samples, CO-alignment to reference genomes and paired-end reads LinkAge to automatically bin contigs into OTUs. Furthermore, COCACOLA seamlessly embraces customized prior knowledge to facilitate binning accuracy.


----------
Description
---------------
This package contains the following files and directories.

	blocknnls.m -> non-negative least square parallel wrapper
	calCorrMat.m -> calculate the pairwise correlation of feature-object matrix
	calInternalIdx.m -> calculate TSS minimization index
	clustAgg_Lmethod.m -> eliminate suspicious clusters using bottom-up L Method
	clustAgg_SepCond.m -> merge closely mixed clusters by separable conductance
	example.m -> a demo on simulated 'strain' dataset
	myKmeansPar.m -> implementation of k-means clustering
	myNMF.m -> key algorithm
	data -> example datasets directory
	nmf_bpas -> non-negative least square algorithm developed by Kim and Park [1,2]
	vlfeat-0.9.20 -> open source library implements very fast version of k-means [3]

Please try to execute 'example.m' to learn how to use this software given the input generated by CONCOCT [4]. And please check the description of 'myNMF.m' for the detailed usage of the algorithm.


----------
Preprocessing
---------------

The preprocessing steps aim to extract coverage profile and sequence composition profile as input to our program, which can be tackled by CONCOCT [4]. Here we provide a step-by-step guidance on simulated 'strain' dataset: 

First of all, we changes the current working directory to the data folder.
```sh
$ cd data/StrainMock
```
We need to set the directories of dependency software in environmental variables. Notice that the setting in the example may differ from your own.
```sh
$ CONCOCT_dir=/home/cmb-panasas2/ylu465/CONCOCT-master/
$ BOWTIE_dir=/home/cmb-panasas2/ylu465/bowtie2-2.2.3/
$ SAMTOOLS_dir=/home/cmb-panasas2/ylu465/samtools-1.1/bin/
```






----------
Contacts and bug reports
------------------------
Please send bug reports, comments, or questions to 

Yang Lu: [ylu465@usc.edu](mailto:ylu465@usc.edu)

Prof. Fengzhu Sun: [fsun@usc.edu](mailto:fsun@usc.edu)


----------
Copyright and License Information
---------------------------------
Copyright (C) 2016 University of Southern California, Yang Lu

Authors: Yang Lu

This program is free software: you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with
this program. If not, see http://www.gnu.org/licenses/.


----------
References
---------------------------------
[1] Kim, H., Park, H.: Nonnegative matrix factorization based on alternating nonnegativity constrained least squares and active set method. SIAM Journal on Matrix Analysis and Applications 30(2), 713-730 (2008)

[2] Kim, J., He, Y., Park, H.: Algorithms for nonnegative matrix and tensor factorizations: A unified view based on block coordinate descent framework. Journal of Global Optimization 58(2), 285-319 (2014)

[3] http://www.vlfeat.org/

[4] Alneberg, J., Bjarnason, B.S., de Bruijn, I., Schirmer, M., Quick, J., Ijaz, U.Z., Lahti, L., Loman, N.J., Andersson, A.F., Quince, C.: Binning metagenomic contigs by coverage and composition. Nature Methods 11(11), 1144-1146 (2014)


Last update: 02-Feb-2016
